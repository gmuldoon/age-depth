
% An age profile with associated errors is available at the WAIS Divide ice core site (Buizert, personal communication 2016), however the  site lacks a robust measure of uncertainty. To derive Byrd ice core, we use volcanic events  detected in the Byrd ice core using the electrical conductivity method \citep{hammer1997}. We assume a 3\% uncertainty on the volcanic ages as a rule of thumb (personal communication, T.J. Fudge). We then invert for age given layer depth using a Bayesian MCMC approach and check our result by correlation to the nearby WAIS Divide ice core chronology.

% Our approach uses a Metropolis algorithm to fit an ice flow model to the observed volcanic profile from the Byrd ice core. An ensemble of well-fitting ice flow models is generated from this process which samples uncertainty in age given uncertainty in depth. We then sample from this ensemble to construct a distribution of likely ages for layers of interest. This method allows us to build a model using data from the last 50,000 years which can be used to estimate uncertainties in the chronology at earlier times.

To estimate the age-depth profile at the Byrd ice core, we use Bayesian calibration to invert for the age and depth of observed englacial radar reflectors. This problem is nontrivial because the age of each reflector depends on solutions elsewhere in the ice column, so each is correlated with depth. We represent the solution as an ensemble because the presence of nonunique solutions necessitates a probabilistic approach.

This method preserves the chronologic superposition of the ice column, estimates the probability of ice flow parameter values, and develops a probabilistic estimate of the age-depth profile. A probabilistic approach is useful because while some parameters are well known, others are highly uncertain, such as the accumulation function at this site over time. By iteratively inverting for non-unique solutions, we find a distribution of sets of parameter values which are consistent with observations. Specifically, we derive an ensemble of age-depth profiles for the Byrd ice core constrained by agreement with a chronology of volcanic events from the past 50,000 years detected in the Byrd ice core record using the electrical conductivity method \citep{hammer1997}. 


%\textbf{MOVE We assume a base level of 1\% uncertainty on the volcanic ages and include a precision parameter, \textit{S}, to quantify additional uncertainty. We invert for age given depth using a Bayesian Markov Chain Monte Carlo approach and check our result by correlation to the nearby WAIS Divide ice core chronology.}

The Bayesian formulation of this problem is:
\begin{equation}\label{bigproblem}
\begin{split} %allow line break
%\begin{flalign}
%\begin{aligned}
p(A_r)  \sim  p(D_r,\vec{f},d_{firn},v_{ice},S | TWTT_r,A_{IC},D_{IC})  \propto & \\
 p(TWTT_r | D_r,d_{firn},v_{ice})   \cdot p(A_{IC},D_{IC} | \vec{f},S&) \cdot p(D_r,f,S) \cdot p(d_{firn})\cdot p(v_{ice})
%\end{flalign}
%\end{aligned}
\end{split}
\end{equation}

Computing the posterior probability distribution of reflector ages requires first estimating the depths of the englacial reflectors of interest ($D_r$), ice flow model parameters ($\vec{f}$), firn depth correction ($d_{firn}$), radar velocity in ice ($v_{ice}$), and a precision of the Byrd ice core chronology ($S$). We estimate these values given information about observed radar reflector two-way travel time ($TWTT_r$) and the age-depth profile from the Byrd ice core volcanic record ($A_{IC}$, $D_{IC}$). 


Likelihood functions, the first two factors on the right-hand side of Equation~\ref{bigproblem}, describe the probability that modeled results agree with observations: in the first, agreement between observed two-way travel time ($TWTT_r$) and modeled reflector depths ($D_r$) and in the second, agreement between flow model results ($f$) and the volcanic ages ($A_{IC}$). Priors, the remaining terms on the right-hand side of Equation~\ref{bigproblem}, are used to put physical bounds on estimates of quantities of interest. Priors on ${D_r}$ also preserve stratigraphic dependence of radar reflectors, requiring deeper reflectors be older than shallower reflectors. 

Accepted solutions are expected to satisfy all of these conditions, so the probabilities are multipled in Equation~\ref{bigproblem}. The Metropolis algorithm is used to identify combinations of parameters and boundary conditions consistent with observations and sources of uncertainty. To do so, sets of parameter values for $D_r$, $\vec{f}$, $S$, $d_{firn}$, and $v_{ice}$ are proposed using a markov chain method. %This method allows us to build a model using data from the last 50,000 years which can be used to estimate uncertainties in the chronology at earlier times.
Likelihood functions for age, $p(A_{IC},D_{IC} | \vec{f},S)$, and TWTT, $p(TWTT_r | D_r,d_{firn},v_{ice})$, are evaluated to accept or reject these proposed parameter sets based on how well they agree with the data. Solutions are those parameter sets which are simultaneously consistent with physical limits defined by the priors and with uncertain observations. 

The resulting posterior probability distribution, $p(D_r, \vec{f},S | TWTT_r, A_{IC}, D_{IC})$, can then be used to deterministically compute the corresponding probability distribution of the age of observed radar reflectors, $p(A_r)$, using the flow model described below.


\input{Sections/flowModel}
\input{Sections/depthError}\label{radardepth}
\input{Sections/metropolis}
%\input{Sections/accumComparison}



