
% An age profile with associated errors is available at the WAIS Divide ice core site (Buizert, personal communication 2016), however the  site lacks a robust measure of uncertainty. To derive Byrd ice core, we use volcanic events  detected in the Byrd ice core using the electrical conductivity method \citep{hammer1997}. We assume a 3\% uncertainty on the volcanic ages as a rule of thumb (personal communication, T.J. Fudge). We then invert for age given layer depth using a Bayesian MCMC approach and check our result by correlation to the nearby WAIS Divide ice core chronology.

% Our approach uses a Metropolis algorithm to fit an ice flow model to the observed volcanic profile from the Byrd ice core. An ensemble of well-fitting ice flow models is generated from this process which samples uncertainty in age given uncertainty in depth. We then sample from this ensemble to construct a distribution of likely ages for layers of interest. This method allows us to build a model using data from the last 50,000 years which can be used to estimate uncertainties in the chronology at earlier times.

To estimate the age-depth profile at the Byrd ice core, we use a Bayesian Markov Chain Monte Carlo technique to invert for the age and depth of observed englacial radar reflectors. This method preserves the depth correlation of the ice core chronology, estimates the probability of ice sheet parameter values, and develops a probabilistic estimate of the age-depth profile. 

We derive an ensemble of age-depth profiles for the Byrd ice core constrained by agreement with a chronology of volcanic events from the past 50,000 years detected in the Byrd ice core record using the electrical conductivity method \citep{hammer1997}. 

We assume a base level of 1\% uncertainty on the volcanic ages and include a precision parameter, \textit{S}, to quantify additional uncertainty. We invert for age given depth using a Bayesian Markov Chain Monte Carlo approach and check our result by correlation to the nearby WAIS Divide ice core chronology.

The Bayesian formulation of this problem is:
\begin{equation}\label{bigproblem}
%\begin{split} %allow line break
%\begin{flalign}
%\begin{aligned}
p(A_r)  \sim \\ p(D_r, \vec{f},d_{firn},v_{ice},S | TWTT_r, A_{IC}, D_{IC})  \propto
p(TWTT_r | D_r,d_{firn},v_{ice} )~p(A_{IC}, D_{IC} | \vec{f},S)~p(D_r, f, S)~p(d_{firn})~p(v_{ice})\
%\end{flalign}
%\end{aligned}
%\end{split}
\end{equation}

Equation \ref{bigproblem} describes how we will estimate the depths of four englacial reflectors ($D_r$), ice flow model parameters ($\vec{f}$), and a precision parameter on the uncertainty in the Byrd ice core chronology ($S$). Values for these quantities of interest will be informed by  information about observed reflector two-way travel time to each reflector observed by from radar ($TWTT_r$) and the age-depth profile from the Byrd ice core volcanic record ($A_{IC}$, $D_{IC}$). 

Priors on the quantities of interest as well as firn depth correction ($d_{firn}$) and velocity of electromagnetic waves in ice ($v_{ice}$), which contribute to errors in ice-penetrating radar depth, are used to put physical bounds on their values. Priors on ${D_r}$ also preserve stratigraphic dependence of radar reflectors, requiring deeper reflectors be older than shallower reflectors. The first two factors on the right-hand side of Equation~\ref{bigproblem} are likelihood functions. These describe the probability that modeled results agree with observations: in the first, agreement between observed two-way travel time ($TWTT_r$) and modeled reflector depths ($D_r$) and in the second, agreement between flow model results ($f$) and the volcanic ages ($A_{IC}$). 

The Metropolis algorithm is used to invert for parameter values consistent with observed ice core chronology and radar reflector data, effectively optimizing the likelihoods. Sets of parameter values for $D_r$, $\vec{f}$, $S$, $d_{firn}$, and $v_{ice}$ are proposed which sample uncertainty in age and depth. %This method allows us to build a model using data from the last 50,000 years which can be used to estimate uncertainties in the chronology at earlier times.
Likelihood functions for age, $p(A_{IC} | D_{IC},\vec{f},S)$, and TWTT, $p(TWTT_r | D_r,d_{firn},v_{ice})$, are evaluated to accept or reject proposed parameter sets based on how well they agree with the data. Accepted parameter values are those which are consistent with physical limits defined by the priors and with observations to within uncertainty. The resulting posterior probability distribution, $p(D_r, \vec{f},S | TWTT_r, A_{IC}, D_{IC})$, can then be used to deterministically compute the corresponding probability distribution of the age of observed radar reflectors, $p(A_r)$, using the flow model described below.


\input{Sections/flowModel}
\input{Sections/depthError}\label{radardepth}
\input{Sections/metropolis}
%\input{Sections/accumComparison}



