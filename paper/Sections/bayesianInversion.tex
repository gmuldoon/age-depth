
% An age profile with associated errors is available at the WAIS Divide ice core site (Buizert, personal communication 2016), however the  site lacks a robust measure of uncertainty. To derive Byrd ice core, we use volcanic events  detected in the Byrd ice core using the electrical conductivity method \citep{hammer1997}. We assume a 3\% uncertainty on the volcanic ages as a rule of thumb (personal communication, T.J. Fudge). We then invert for age given layer depth using a Bayesian MCMC approach and check our result by correlation to the nearby WAIS Divide ice core chronology.

% Our approach uses a Metropolis algorithm to fit an ice flow model to the observed volcanic profile from the Byrd ice core. An ensemble of well-fitting ice flow models is generated from this process which samples uncertainty in age given uncertainty in depth. We then sample from this ensemble to construct a distribution of likely ages for layers of interest. This method allows us to build a model using data from the last 50,000 years which can be used to estimate uncertainties in the chronology at earlier times.

In order to assign ages to observed radar reflectors, we are interested in combining information from radar, ice flow physics, and dates from ice core volcanics at the Byrd ice core site. To do so, we take advantage of the versatility of a Bayesian approach to assemble the desired solution from a set of inter-related components.  Our method preserves the chronologic superposition of the ice column and correlation of errors with depth, estimates the probability of ice flow parameter values, and estimates a joint probability of the age-depth profile. 

%because while some parameters are well known, others are highly uncertain, such as the accumulation function at this site over time. By iteratively inverting for non-unique solutions, we find a distribution of sets of parameter values which are consistent with observations. Specifically, we derive an ensemble of age-depth profiles for the Byrd ice core constrained by agreement with a chronology of volcanic events from the past 50,000 years detected in the Byrd ice core record using electrical conductivity \citep{hammer1997} and with TWTT to bright, continuous reflectors observed in ice-penetrating radar \citep{holt2006,young2012,morse2002} and traced using Landmark seismic interpretation software produced by Halliburton.


%\textbf{MOVE We assume a base level of 1\% uncertainty on the volcanic ages and include a precision parameter, \textit{S}, to quantify additional uncertainty. We invert for age given depth using a Bayesian Markov Chain Monte Carlo approach and check our result by correlation to the nearby WAIS Divide ice core chronology.}

The Bayesian formulation of this problem is:
\begin{equation}\label{eqn:bigproblem}
\begin{split} %allow line break
%\begin{flalign}
\begin{aligned}
PPD(A_r)  \sim  PPD(D_r,\vec{f},d_{firn},v_{ice},S | TWTT_r,A_{IC},D_{IC})  \propto & \\
        p(TWTT_r | D_r,d_{firn},v_{ice}) \cdot p(A_{IC},D_{IC} | \vec{f},S)  \cdot p(D_r) \cdot p(\vec{f}) &\cdot p(S) \cdot p(d_{firn})\cdot p(v_{ice})
%\end{flalign}
\end{aligned}
\end{split}
\end{equation}

Computing the posterior joint probability distribution of reflector ages, $PPD(A_r)$ in Equation~\ref{eqn:bigproblem}, requires jointly estimating the depths of the englacial reflectors of interest ($D_r$), ice flow model parameters and accumulation history ($\vec{f}$), firn depth correction ($d_{firn}$), radar velocity in ice ($v_{ice}$), and precision of the Byrd ice core chronology ($S$). We estimate these values given information about observed radar reflector two-way travel time ($TWTT_r$) and the ages and depths ($A_{IC}$, $D_{IC}$) of volcanics interpreted from the Byrd ice core record. 


We use priors, the rightmost three terms in Equation~\ref{eqn:bigproblem}, to put physical bounds on estimates of quantities of interest as described in the following sections. Priors on ${D_r}$ also preserve stratigraphic dependence of radar reflectors, requiring deeper reflectors be older than shallower reflectors. Likelihood functions, the remaining two factors on the right-hand side of Equation~\ref{eqn:bigproblem}, describe the probability that evaluates if ice flow and radar model results agree with observations. With candidate solutions pulled initially from their prior distriubtions, the two likelihood functions test first the sampled ice flow parameters and accumulation history ($\vec{f}$) to generate an age-depth profile consistent with the volcanic ages and depths ($A_{IC}$, $D_{IC}$). The scatter remaining between this fit determines precision ($S$) and the likelihood the first test is rejected or accepted. The second likelihood tests %Sampling first the agreement between flow model results ($\vec{f}$) and the volcanic record ($A_{IC}$, $D_{IC}$) helps to determine precision, $S$, which is given by the scatter between published ages and ice flow model ages.  Secondly, 
agreement between observed two-way travel time ($TWTT_r$) and modeled reflector depths ($D_r$) using information about the local firn correction ($d_{firn}$) and radar velocity in ice ($v_{ice}$). These elements of Equation~\ref{eqn:bigproblem} are discussed more thoroughly in subsequent sections. The supplement provides a more detailed description of how the sequence of sampling and acceptance/rejection was implemented.

%Accepted solutions are expected to satisfy all of these conditions simultaneously, so we take the product of their probabilities in Equation~\ref{eqn:bigproblem}. The Metropolis algorithm \citep{metropolis1953} is used to sample combinations of parameters and boundary conditions consistent with the problem as described. To do so, sets of parameter values for $D_r$, $\vec{f}$, $S$, $d_{firn}$, and $v_{ice}$ are selected according to the Gibbs-Hastings method which steps through parameter space using a proposal based on the previous accepted parameter set, i.e. a markov chain.  (See supplement.) %This method allows us to build a model using data from the last 50,000 years which can be used to estimate uncertainties in the chronology at earlier times.
%Likelihood functions for age and TWTT are evaluated to accept or reject these proposed parameter sets based on the change in distance between the proposed solution and observations compared to the previous step. Solutions are those parameter sets which are the most consistent with observations given the physical limits defined by the priors, observational uncertainty, and scatter between the model and observations. We use 100,000 iterations to estimate the solution to Equation~\ref{eqn:bigproblem}. The resulting ensemble of parameter sets are used to generate an ensemble of age-depth profiles. The resulting posterior probability distribution, $p(D_r, \vec{f},S | TWTT_r, A_{IC}, D_{IC})$, samples the age uncertainty in the Byrd ice core in proportion to the combined probabilities and the age of observed radar reflectors, $p(A_r)$, using the flow model described below.


\input{Sections/flowModel}
\input{Sections/depthError}\label{radardepth}
\input{Sections/metropolis}
%\input{Sections/accumComparison}



